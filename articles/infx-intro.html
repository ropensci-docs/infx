<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to infx • rOpenSci: infx</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- ropensci --><link href="../ropensci.css?nocache=123" rel="stylesheet">
<meta property="og:title" content="Introduction to infx">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-462421-8"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-462421-8');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a href="https://ropensci.org"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
        <a class="navbar-brand" href="../index.html"><i>infx <small>v0.1.0</small></i></a>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/infx-intro.html">Introduction to infx</a>
    </li>
    <li>
      <a href="../articles/json-class.html">JSON object handling</a>
    </li>
    <li>
      <a href="../articles/openbis-api.html">OpenBIS API coverage</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
        
      </ul>
<form class="navbar-form navbar-right docsearch" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to infx</h1>
                        <h4 class="author">Nicolas Bennett</h4>
            
            <h4 class="date">2020-02-21</h4>
      
      
      <div class="hidden name"><code>infx-intro.Rmd</code></div>

    </div>

    
    
<p>OpenBIS (Open Biology Information System) is a laboratory information management system designed for robust data management of large-scale experiments in biological sciences. As storage infrastructure it is therefore well suited for the needs of image-based high throughput screening (HTS) as performed by the InfectX consortium. For data access, JSON-RPC services are provided by openBIS, which can be called from the presented client package <code>infx</code>.</p>
<p>This document gives a short introduction to some basic organizational concepts of openBIS with a focus on aspects relevant to HTS and provides some examples of how the <code>infx</code> can be used to access various types of data generated by the InfectX experiments. For more information, general openBIS documentation is available <a href="https://wiki-bsse.ethz.ch/display/openBISDoc1304/openBIS">here</a> and documentation specific to the JSON-RPC API can be accessed from <a href="https://wiki-bsse.ethz.ch/display/openBISDoc1304/openBIS+JSON+API">here</a>. It might help to have a look at the browser-based web GUI available <a href="https://infectx.biozentrum.unibas.ch/openbis">here</a> alongside this document to help understanding the presented ideas.</p>
<div id="organizational-concepts-in-openbis" class="section level2">
<h2 class="hasAnchor">
<a href="#organizational-concepts-in-openbis" class="anchor"></a>Organizational concepts in openBIS</h2>
<p>An organizational entity central to the openBIS storage logic is an <strong>experiment</strong>. In the context of InfectX, an experiment is a single screen, meaning the combination of a compound library and an experimental condition provided by the presence of a pathogen. For example in the experiment <code>ADENO-AU-K1</code>, a kinome-wide siRNA library by Ambion (Silencer Select) was applied in unpooled fashion (3 siRNAs per gene), alongside exposure to the pathogen Adenovirus (cf. the <code>properties</code> field of <code>Experiment</code> objects as shown below).</p>
<p>Experiments are grouped into <strong>projects</strong> (one per pathogen in the case of InfectX), which in turn are grouped into <strong>spaces</strong> (an unimportant hierarchical level for InfectX). Projects can be listed using <code><a href="../reference/list_projects.html">list_projects()</a></code> and experiments with <code><a href="../reference/list_experiments.html">list_experiments()</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">token &lt;-<span class="st"> </span><span class="kw"><a href="../reference/login.html">login_openbis</a></span>()</a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3">projects &lt;-<span class="st"> </span><span class="kw"><a href="../reference/list_projects.html">list_projects</a></span>(token)</a>
<a class="sourceLine" id="cb1-4" title="4"></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(projects, <span class="dt">length =</span> 10L)</a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co">#&gt; ┌─█─Project </span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co">#&gt; │ ├─permId = 20130710131815818-2788266 </span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co">#&gt; │ ├─spaceCode = INFECTX_PUBLISHED </span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co">#&gt; │ ├─code = ADENO_TEAM </span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co">#&gt; │ ├─description =  </span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co">#&gt; │ ├─registrationDetails = █─EntityRegistrationDetails </span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="co">#&gt; │ │                       └─... </span></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="co">#&gt; │ └─id = 39 </span></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="co">#&gt; ├─█─Project </span></a>
<a class="sourceLine" id="cb1-15" title="15"><span class="co">#&gt; ...</span></a>
<a class="sourceLine" id="cb1-16" title="16"><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(projects)</a>
<a class="sourceLine" id="cb1-17" title="17"><span class="co">#&gt; [1] 12</span></a>
<a class="sourceLine" id="cb1-18" title="18"></a>
<a class="sourceLine" id="cb1-19" title="19">adeno_exps &lt;-<span class="st"> </span><span class="kw"><a href="../reference/list_experiments.html">list_experiments</a></span>(token, projects[[1L]])</a>
<a class="sourceLine" id="cb1-20" title="20"></a>
<a class="sourceLine" id="cb1-21" title="21"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(adeno_exps, <span class="dt">length =</span> 15L)</a>
<a class="sourceLine" id="cb1-22" title="22"><span class="co">#&gt; ┌─█─Experiment </span></a>
<a class="sourceLine" id="cb1-23" title="23"><span class="co">#&gt; │ ├─permId = 20111223100933426-318017 </span></a>
<a class="sourceLine" id="cb1-24" title="24"><span class="co">#&gt; │ ├─code = ADENO-AU-K1 </span></a>
<a class="sourceLine" id="cb1-25" title="25"><span class="co">#&gt; │ ├─identifier = /INFECTX_PUBLISHED/ADENO_TEAM/ADENO-AU-K1 </span></a>
<a class="sourceLine" id="cb1-26" title="26"><span class="co">#&gt; │ ├─experimentTypeCode = SIRNA_HCS </span></a>
<a class="sourceLine" id="cb1-27" title="27"><span class="co">#&gt; │ ├─registrationDetails = █─EntityRegistrationDetails </span></a>
<a class="sourceLine" id="cb1-28" title="28"><span class="co">#&gt; │ │                       └─... </span></a>
<a class="sourceLine" id="cb1-29" title="29"><span class="co">#&gt; │ ├─properties = [GENESET = Kinome, REPLICATE = 1, LIBRARY = Ambion, DESCRIPT... </span></a>
<a class="sourceLine" id="cb1-30" title="30"><span class="co">#&gt; │ ├─metaprojects =  </span></a>
<a class="sourceLine" id="cb1-31" title="31"><span class="co">#&gt; │ ├─stub = FALSE </span></a>
<a class="sourceLine" id="cb1-32" title="32"><span class="co">#&gt; │ └─id = 153 </span></a>
<a class="sourceLine" id="cb1-33" title="33"><span class="co">#&gt; ├─█─Experiment </span></a>
<a class="sourceLine" id="cb1-34" title="34"><span class="co">#&gt; │ ├─permId = 20111223134014190-318046 </span></a>
<a class="sourceLine" id="cb1-35" title="35"><span class="co">#&gt; │ ├─code = ADENO-AU-K2 </span></a>
<a class="sourceLine" id="cb1-36" title="36"><span class="co">#&gt; ...</span></a>
<a class="sourceLine" id="cb1-37" title="37"><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(adeno_exps)</a>
<a class="sourceLine" id="cb1-38" title="38"><span class="co">#&gt; [1] 8</span></a>
<a class="sourceLine" id="cb1-39" title="39"></a>
<a class="sourceLine" id="cb1-40" title="40"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(adeno_exps[[1L]]<span class="op">$</span>properties)</a>
<a class="sourceLine" id="cb1-41" title="41"><span class="co">#&gt; List of 5</span></a>
<a class="sourceLine" id="cb1-42" title="42"><span class="co">#&gt;  $ GENESET    : chr "Kinome"</span></a>
<a class="sourceLine" id="cb1-43" title="43"><span class="co">#&gt;  $ REPLICATE  : chr "1"</span></a>
<a class="sourceLine" id="cb1-44" title="44"><span class="co">#&gt;  $ LIBRARY    : chr "Ambion"</span></a>
<a class="sourceLine" id="cb1-45" title="45"><span class="co">#&gt;  $ DESCRIPTION: chr "Adenovirus Ambion Unpooled Kinome 1 screen (type: Adenovirus Ambion Unpooled Kinome 1 for InfectX)"</span></a>
<a class="sourceLine" id="cb1-46" title="46"><span class="co">#&gt;  $ PATHOGEN   : chr "Adenovirus"</span></a></code></pre></div>
<p>In order to access the API, a login token has to be created. Using this token, all available projects are listed using <code><a href="../reference/list_projects.html">list_projects()</a></code> and all experiments corresponding to a project are listed with <code><a href="../reference/list_experiments.html">list_experiments()</a></code>. As mentioned, some information on the individual experiments is available in the <code>properties</code> entry of <code>Experiment</code> objects.</p>
<p>Experiments in high-throughput screening are typically carried out on microtiter plates which lends itself to a natural way of sub-dividing individual experiments. All InfectX screens were performed on 384 well plates, composed of 16 rows (A through P) and 24 columns (1 through 24) and each plate can be uniquely identified by a barcode. The functions for listing plates and wells are <code><a href="../reference/list_plate_well.html">list_plates()</a></code> and <code><a href="../reference/list_plate_well.html">list_wells()</a></code>, respectively. The following example shows how for a single experiment, all associated plates and for a single plate, all contained wells can be retrieved.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">plates &lt;-<span class="st"> </span><span class="kw"><a href="../reference/list_plate_well.html">list_plates</a></span>(token, adeno_exps[[1L]])</a>
<a class="sourceLine" id="cb2-2" title="2"></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(plates, <span class="dt">length =</span> 15L)</a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co">#&gt; ┌─█─Plate </span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">#&gt; │ ├─permId = 20111223112852092-318030 </span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">#&gt; │ ├─plateCode = BB01-1I </span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">#&gt; │ ├─spaceCodeOrNull = INFECTX_PUBLISHED </span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="co">#&gt; │ ├─experimentCode = ADENO-AU-K1 </span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">#&gt; │ ├─projectCode = ADENO_TEAM </span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">#&gt; │ └─experimentIdentifier = █─ExperimentIdentifier </span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co">#&gt; │                          └─... </span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="co">#&gt; ├─█─Plate </span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="co">#&gt; │ ├─permId = 20111223103313710-318022 </span></a>
<a class="sourceLine" id="cb2-14" title="14"><span class="co">#&gt; │ ├─plateCode = KB2-01-1I </span></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="co">#&gt; │ ├─spaceCodeOrNull = INFECTX_PUBLISHED </span></a>
<a class="sourceLine" id="cb2-16" title="16"><span class="co">#&gt; │ ├─experimentCode = ADENO-AU-K1 </span></a>
<a class="sourceLine" id="cb2-17" title="17"><span class="co">#&gt; │ ├─projectCode = ADENO_TEAM </span></a>
<a class="sourceLine" id="cb2-18" title="18"><span class="co">#&gt; ...</span></a>
<a class="sourceLine" id="cb2-19" title="19"><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(plates)</a>
<a class="sourceLine" id="cb2-20" title="20"><span class="co">#&gt; [1] 7</span></a>
<a class="sourceLine" id="cb2-21" title="21"></a>
<a class="sourceLine" id="cb2-22" title="22">wells &lt;-<span class="st"> </span><span class="kw"><a href="../reference/list_plate_well.html">list_wells</a></span>(token, plates[[<span class="dv">2</span>]])</a>
<a class="sourceLine" id="cb2-23" title="23"></a>
<a class="sourceLine" id="cb2-24" title="24"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(wells, <span class="dt">length =</span> 15L, <span class="dt">depth =</span> 2L)</a>
<a class="sourceLine" id="cb2-25" title="25"><span class="co">#&gt; ┌─█─WellIdentifier </span></a>
<a class="sourceLine" id="cb2-26" title="26"><span class="co">#&gt; │ ├─permId = 20121012092121759-1413198 </span></a>
<a class="sourceLine" id="cb2-27" title="27"><span class="co">#&gt; │ ├─plateIdentifier = █─PlateIdentifier </span></a>
<a class="sourceLine" id="cb2-28" title="28"><span class="co">#&gt; │ │                   ├─plateCode = KB2-01-1I </span></a>
<a class="sourceLine" id="cb2-29" title="29"><span class="co">#&gt; │ │                   └─spaceCodeOrNull = INFECTX_PUBLISHED </span></a>
<a class="sourceLine" id="cb2-30" title="30"><span class="co">#&gt; │ └─wellPosition = █─WellPosition </span></a>
<a class="sourceLine" id="cb2-31" title="31"><span class="co">#&gt; │                  ├─wellRow = 1 </span></a>
<a class="sourceLine" id="cb2-32" title="32"><span class="co">#&gt; │                  └─wellColumn = 1 </span></a>
<a class="sourceLine" id="cb2-33" title="33"><span class="co">#&gt; ├─█─WellIdentifier </span></a>
<a class="sourceLine" id="cb2-34" title="34"><span class="co">#&gt; │ ├─permId = 20121012092121802-1413199 </span></a>
<a class="sourceLine" id="cb2-35" title="35"><span class="co">#&gt; │ ├─plateIdentifier = █─PlateIdentifier </span></a>
<a class="sourceLine" id="cb2-36" title="36"><span class="co">#&gt; │ │                   ├─plateCode = KB2-01-1I </span></a>
<a class="sourceLine" id="cb2-37" title="37"><span class="co">#&gt; │ │                   └─spaceCodeOrNull = INFECTX_PUBLISHED </span></a>
<a class="sourceLine" id="cb2-38" title="38"><span class="co">#&gt; │ └─wellPosition = █─WellPosition </span></a>
<a class="sourceLine" id="cb2-39" title="39"><span class="co">#&gt; ...</span></a>
<a class="sourceLine" id="cb2-40" title="40"><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(wells)</a>
<a class="sourceLine" id="cb2-41" title="41"><span class="co">#&gt; [1] 384</span></a></code></pre></div>
<p>In terms of openBIS entities, both a plate and a well are considered <strong>samples</strong>. A sample is described as follows by the <a href="https://wiki-bsse.ethz.ch/display/openBISDoc1304/openBIS+User+Documentation#openBISUserDocumentation-Introduction">openBIS user documentation</a>:</p>
<blockquote>
<p>A sample refers to any object that has been observed, measured, or compared to another. It must be uniquely identifiable, which means that any two samples must be distinguishable from one another. Please note that different use cases may use the term “sample” with slightly different meanings, dependent upon the context and utility. … [T]he term “sample” could [for example] refer to an individual well in a multi-titer plate containing cells of different phenotypes.</p>
</blockquote>
<p>The function <code><a href="../reference/list_samples.html">list_samples()</a></code> retrieves <code>Sample</code> objects, which generalize <code>PlateIdentifier</code> and <code>WellIdentifier</code> objects. As with many other <code>infx</code> functions, <code><a href="../reference/list_samples.html">list_samples()</a></code> is an S3 generic function. If dispatch occurs on an <code>Experiment</code> object, the set of plate samples belonging to an experiment is fetched, as with <code><a href="../reference/list_plate_well.html">list_plates()</a></code>. Well samples per plate cannot be directly listed as was the case with <code><a href="../reference/list_plate_well.html">list_wells()</a></code>. However <code><a href="../reference/list_samples.html">list_samples()</a></code> dispatched on a set of <code>WellIdentifier</code> objects will return the corresponding well samples.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">plate_samp &lt;-<span class="st"> </span><span class="kw"><a href="../reference/list_samples.html">list_samples</a></span>(token, adeno_exps[[1L]])</a>
<a class="sourceLine" id="cb3-2" title="2"></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(plate_samp, <span class="dt">length =</span> 20L)</a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co">#&gt; ┌─█─Sample </span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co">#&gt; │ ├─spaceCode = INFECTX_PUBLISHED </span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">#&gt; │ ├─permId = 20111223112852092-318030 </span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co">#&gt; │ ├─code = BB01-1I </span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co">#&gt; │ ├─identifier = /INFECTX_PUBLISHED/BB01-1I </span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="co">#&gt; │ ├─experimentIdentifierOrNull = /INFECTX_PUBLISHED/ADENO_TEAM/ADENO-AU-K1 </span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co">#&gt; │ ├─sampleTypeCode = PLATE </span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co">#&gt; │ ├─properties = [$PLATE_GEOMETRY = 384_WELLS_16X24, PLATE_TYPE = CheckerBoar... </span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co">#&gt; │ ├─registrationDetails = █─EntityRegistrationDetails </span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co">#&gt; │ │                       └─... </span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="co">#&gt; │ ├─retrievedFetchOptions = [BASIC, PROPERTIES, METAPROJECTS] </span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="co">#&gt; │ ├─parents =  </span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="co">#&gt; │ ├─children =  </span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="co">#&gt; │ ├─stub = FALSE </span></a>
<a class="sourceLine" id="cb3-18" title="18"><span class="co">#&gt; │ ├─sampleTypeId = 3 </span></a>
<a class="sourceLine" id="cb3-19" title="19"><span class="co">#&gt; │ ├─metaprojects =  </span></a>
<a class="sourceLine" id="cb3-20" title="20"><span class="co">#&gt; │ └─id = 285657 </span></a>
<a class="sourceLine" id="cb3-21" title="21"><span class="co">#&gt; ├─█─Sample </span></a>
<a class="sourceLine" id="cb3-22" title="22"><span class="co">#&gt; │ ├─spaceCode = INFECTX_PUBLISHED </span></a>
<a class="sourceLine" id="cb3-23" title="23"><span class="co">#&gt; ...</span></a>
<a class="sourceLine" id="cb3-24" title="24"><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(plate_samp)</a>
<a class="sourceLine" id="cb3-25" title="25"><span class="co">#&gt; [1] 7</span></a>
<a class="sourceLine" id="cb3-26" title="26"></a>
<a class="sourceLine" id="cb3-27" title="27">wells_samp &lt;-<span class="st"> </span><span class="kw"><a href="../reference/list_samples.html">list_samples</a></span>(token, wells[1L<span class="op">:</span>2L])</a>
<a class="sourceLine" id="cb3-28" title="28"></a>
<a class="sourceLine" id="cb3-29" title="29"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(wells_samp, <span class="dt">length =</span> 20L)</a>
<a class="sourceLine" id="cb3-30" title="30"><span class="co">#&gt; ┌─█─Sample </span></a>
<a class="sourceLine" id="cb3-31" title="31"><span class="co">#&gt; │ ├─spaceCode = INFECTX_PUBLISHED </span></a>
<a class="sourceLine" id="cb3-32" title="32"><span class="co">#&gt; │ ├─permId = 20121012092121759-1413198 </span></a>
<a class="sourceLine" id="cb3-33" title="33"><span class="co">#&gt; │ ├─code = KB2-01-1I:A1 </span></a>
<a class="sourceLine" id="cb3-34" title="34"><span class="co">#&gt; │ ├─identifier = /INFECTX_PUBLISHED/KB2-01-1I:A1 </span></a>
<a class="sourceLine" id="cb3-35" title="35"><span class="co">#&gt; │ ├─experimentIdentifierOrNull =  </span></a>
<a class="sourceLine" id="cb3-36" title="36"><span class="co">#&gt; │ ├─sampleTypeCode = SIRNA_WELL </span></a>
<a class="sourceLine" id="cb3-37" title="37"><span class="co">#&gt; │ ├─properties = [WELL_QUALITY_STATUS = UNKNOWN, INHIBITOR_OF = 1119 (GENE), ... </span></a>
<a class="sourceLine" id="cb3-38" title="38"><span class="co">#&gt; │ ├─registrationDetails = █─EntityRegistrationDetails </span></a>
<a class="sourceLine" id="cb3-39" title="39"><span class="co">#&gt; │ │                       └─... </span></a>
<a class="sourceLine" id="cb3-40" title="40"><span class="co">#&gt; │ ├─retrievedFetchOptions = [BASIC, PROPERTIES, METAPROJECTS] </span></a>
<a class="sourceLine" id="cb3-41" title="41"><span class="co">#&gt; │ ├─parents =  </span></a>
<a class="sourceLine" id="cb3-42" title="42"><span class="co">#&gt; │ ├─children =  </span></a>
<a class="sourceLine" id="cb3-43" title="43"><span class="co">#&gt; │ ├─stub = FALSE </span></a>
<a class="sourceLine" id="cb3-44" title="44"><span class="co">#&gt; │ ├─sampleTypeId = 7 </span></a>
<a class="sourceLine" id="cb3-45" title="45"><span class="co">#&gt; │ ├─metaprojects =  </span></a>
<a class="sourceLine" id="cb3-46" title="46"><span class="co">#&gt; │ └─id = 1283356 </span></a>
<a class="sourceLine" id="cb3-47" title="47"><span class="co">#&gt; └─█─Sample </span></a>
<a class="sourceLine" id="cb3-48" title="48"><span class="co">#&gt;   ├─spaceCode = INFECTX_PUBLISHED </span></a>
<a class="sourceLine" id="cb3-49" title="49"><span class="co">#&gt; ...</span></a></code></pre></div>
<p>The sample type is encoded in the <code>sampleTypeCode</code> field of each <code>Sample</code> object and an exhaustive list of available sample types can be shown using <code><a href="../reference/list_samples.html">list_sample_types()</a></code>.</p>
<p>A further important organizational concept of openBIS is that of a <strong>data set</strong>. On this entity, the <a href="https://wiki-bsse.ethz.ch/display/openBISDoc1304/openBIS+User+Documentation#openBISUserDocumentation-Introduction">openBIS user documentation</a> notes the following:</p>
<blockquote>
<p>A data set is the computer’s representation of a series of sample measurements, or the results of computational processing derived from those measurements. As with samples and experiments, data sets also have specific data set types to better handle searching and analysis needs.</p>
</blockquote>
<p>Essentially, a data set represents a collection of files associated with a sample. Furthermore data sets may have (multiple) parent/child relationships among each other, to indicate one data set being derived of another. Retrieving all data sets belonging to a plate can be achieved with calling <code><a href="../reference/list_datasets.html">list_datasets()</a></code> on plate sample objects.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">data_sets &lt;-<span class="st"> </span><span class="kw"><a href="../reference/list_datasets.html">list_datasets</a></span>(token, plate_samp[[2L]])</a>
<a class="sourceLine" id="cb4-2" title="2"></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(data_sets, <span class="dt">length =</span> 30L)</a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co">#&gt; ┌─█─DataSet </span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="co">#&gt; │ ├─code = 20111223111124453-318029 </span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co">#&gt; │ ├─experimentIdentifier = /INFECTX_PUBLISHED/ADENO_TEAM/ADENO-AU-K1 </span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="co">#&gt; │ ├─sampleIdentifierOrNull = /INFECTX_PUBLISHED/KB2-02-1I </span></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="co">#&gt; │ ├─dataSetTypeCode = HCS_IMAGE_CONTAINER_RAW </span></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="co">#&gt; │ ├─containerDataSet = TRUE </span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="co">#&gt; │ ├─linkDataSet = FALSE </span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="co">#&gt; │ ├─storageConfirmed = TRUE </span></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="co">#&gt; │ ├─externalDataSetCode =  </span></a>
<a class="sourceLine" id="cb4-13" title="13"><span class="co">#&gt; │ ├─externalDataSetLink =  </span></a>
<a class="sourceLine" id="cb4-14" title="14"><span class="co">#&gt; │ ├─externalDataManagementSystem =  </span></a>
<a class="sourceLine" id="cb4-15" title="15"><span class="co">#&gt; │ ├─properties = [IBRAIN2.DATASET.ID = 20714, IMAGE.BIT.DEPTH = 12, ACQUISITI... </span></a>
<a class="sourceLine" id="cb4-16" title="16"><span class="co">#&gt; │ ├─metaprojects =  </span></a>
<a class="sourceLine" id="cb4-17" title="17"><span class="co">#&gt; │ ├─retrievedConnections =  </span></a>
<a class="sourceLine" id="cb4-18" title="18"><span class="co">#&gt; │ ├─parentCodes =  </span></a>
<a class="sourceLine" id="cb4-19" title="19"><span class="co">#&gt; │ ├─childrenCodes =  </span></a>
<a class="sourceLine" id="cb4-20" title="20"><span class="co">#&gt; │ ├─containedDataSets = ... </span></a>
<a class="sourceLine" id="cb4-21" title="21"><span class="co">#&gt; │ ├─containerOrNull =  </span></a>
<a class="sourceLine" id="cb4-22" title="22"><span class="co">#&gt; │ ├─registrationDetails = █─EntityRegistrationDetails </span></a>
<a class="sourceLine" id="cb4-23" title="23"><span class="co">#&gt; │ │                       └─... </span></a>
<a class="sourceLine" id="cb4-24" title="24"><span class="co">#&gt; │ ├─fetchOptions =  </span></a>
<a class="sourceLine" id="cb4-25" title="25"><span class="co">#&gt; │ ├─postRegistered = TRUE </span></a>
<a class="sourceLine" id="cb4-26" title="26"><span class="co">#&gt; │ ├─stub = FALSE </span></a>
<a class="sourceLine" id="cb4-27" title="27"><span class="co">#&gt; │ └─id = 25875 </span></a>
<a class="sourceLine" id="cb4-28" title="28"><span class="co">#&gt; ├─█─DataSet </span></a>
<a class="sourceLine" id="cb4-29" title="29"><span class="co">#&gt; │ ├─code = 20120629020422290-603089 </span></a>
<a class="sourceLine" id="cb4-30" title="30"><span class="co">#&gt; │ ├─experimentIdentifier = /INFECTX_PUBLISHED/ADENO_TEAM/ADENO-AU-K1 </span></a>
<a class="sourceLine" id="cb4-31" title="31"><span class="co">#&gt; │ ├─sampleIdentifierOrNull = /INFECTX_PUBLISHED/KB2-02-1I </span></a>
<a class="sourceLine" id="cb4-32" title="32"><span class="co">#&gt; │ ├─dataSetTypeCode = CLUSTER_JOB_LOGS </span></a>
<a class="sourceLine" id="cb4-33" title="33"><span class="co">#&gt; ...</span></a>
<a class="sourceLine" id="cb4-34" title="34"><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(data_sets)</a>
<a class="sourceLine" id="cb4-35" title="35"><span class="co">#&gt; [1] 34</span></a>
<a class="sourceLine" id="cb4-36" title="36"></a>
<a class="sourceLine" id="cb4-37" title="37"><span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="kw"><a href="../reference/json_utils.html">get_field</a></span>(data_sets, <span class="st">"dataSetTypeCode"</span>))</a>
<a class="sourceLine" id="cb4-38" title="38"><span class="co">#&gt;  [1] "HCS_IMAGE_CONTAINER_RAW"                                </span></a>
<a class="sourceLine" id="cb4-39" title="39"><span class="co">#&gt;  [2] "CLUSTER_JOB_LOGS"                                       </span></a>
<a class="sourceLine" id="cb4-40" title="40"><span class="co">#&gt;  [3] "HCS_CHANNEL_SHADINGCORR_IMAGES"                         </span></a>
<a class="sourceLine" id="cb4-41" title="41"><span class="co">#&gt;  [4] "CLUSTER_JOB_PROFILING"                                  </span></a>
<a class="sourceLine" id="cb4-42" title="42"><span class="co">#&gt;  [5] "HCS_ANALYSIS_CELL_FEATURES_CC_MAT"                      </span></a>
<a class="sourceLine" id="cb4-43" title="43"><span class="co">#&gt;  [6] "HCS_ANALYSIS_PLATE_FEATURES_ESTIMATES"                  </span></a>
<a class="sourceLine" id="cb4-44" title="44"><span class="co">#&gt;  [7] "HCS_ANALYSIS_CONTAINER_WELL_RESULTS_SUMMARIES"          </span></a>
<a class="sourceLine" id="cb4-45" title="45"><span class="co">#&gt;  [8] "HCS_ANALYSIS_WELL_THRESHOLDEDINFECTIONSCORING_SUMMARIES"</span></a>
<a class="sourceLine" id="cb4-46" title="46"><span class="co">#&gt;  [9] "HCS_ANALYSIS_CELL_THRESHOLDEDINFECTIONSCORING_MAT"      </span></a>
<a class="sourceLine" id="cb4-47" title="47"><span class="co">#&gt; [10] "HCS_IMAGE_CONTAINER_SEGMENTATION"                       </span></a>
<a class="sourceLine" id="cb4-48" title="48"><span class="co">#&gt; [11] "HCS_ANALYSIS_CELL_CLASSIFICATIONS_MAT"                  </span></a>
<a class="sourceLine" id="cb4-49" title="49"><span class="co">#&gt; [12] "HCS_ANALYSIS_CONTAINER_WELL_CLASSIFICATION_SUMMARIES"   </span></a>
<a class="sourceLine" id="cb4-50" title="50"><span class="co">#&gt; [13] "HCS_ANALYSIS_IMAGE_ACQUISITION_METADATA"                </span></a>
<a class="sourceLine" id="cb4-51" title="51"><span class="co">#&gt; [14] "HCS_BEE_ANALYSIS_PROPERTIES"                            </span></a>
<a class="sourceLine" id="cb4-52" title="52"><span class="co">#&gt; [15] "HCS_QUALITYCONTROL_INFORMATION"</span></a>
<a class="sourceLine" id="cb4-53" title="53"></a>
<a class="sourceLine" id="cb4-54" title="54"><span class="kw"><a href="../reference/list_datasets.html">list_datasets</a></span>(token, wells_samp[[1L]])</a>
<a class="sourceLine" id="cb4-55" title="55"><span class="co">#&gt; list()</span></a></code></pre></div>
<p>Several different types of data sets (possibly in multiple versions) are typically associated with a plate. Some of the more interesting data set types are</p>
<ul>
<li>
<code>HCS_IMAGE_CONTAINER_RAW</code>: raw imaging data, 6-9 images per well each available for 3-4 imaging channels</li>
<li>
<code>HCS_IMAGE_CONTAINER_SEGMENTATION</code>: image overlays for segmenting images into cells, nuclei, etc.</li>
<li>
<code>HCS_ANALYSIS_IMAGE_ACQUISITION_METADATA</code>: microscope image meta data and settings</li>
<li>
<code>HCS_ANALYSIS_CELL_FEATURES_CC_MAT</code>: CellProfiler feature data at single cell resolution</li>
<li>
<code>HCS_ANALYSIS_CELL_CLASSIFICATIONS_MAT</code>: decision tree-based infection scoring data</li>
</ul>
<p>The way openBIS is set up for InfectX, data sets are only available on the plate sample level and not per well, as is demonstrated by passing a well sample object to <code><a href="../reference/list_datasets.html">list_datasets()</a></code>, which returns an empty list.</p>
</div>
<div id="searching-in-openbis" class="section level2">
<h2 class="hasAnchor">
<a href="#searching-in-openbis" class="anchor"></a>Searching in openBIS</h2>
<p>Search queries for openBIS are constructed with <code><a href="../reference/search_openbis.html">search_criteria()</a></code> and the search is executed by calling <code><a href="../reference/search_openbis.html">search_openbis()</a></code>. The function <code><a href="../reference/search_openbis.html">search_criteria()</a></code> instantiates a <code>SearchCriteria</code> object which consists of a set of match clauses combined with either an <code>any</code> or <code>all</code> operator. Nesting of <code>SearchCriteria</code> objects is possibly by supplying a <code>SearchCriteria</code> object as <code>sub_criteria</code> argument to a call to <code><a href="../reference/search_openbis.html">search_criteria()</a></code>, in turn creating the enclosing <code>SearchCriteria</code> object.</p>
<p>Five different types of match clauses can be constructed:</p>
<ul>
<li>
<code>PropertyMatchClause</code>: A <code>MatchClause</code> for checking that a property equals a desired value.</li>
<li>
<code>AnyPropertyMatchClause</code>: A <code>MatchClause</code> for checking that any of the properties equals a desired value.</li>
<li>
<code>AnyFieldMatchClause</code>: A <code>MatchClause</code> for checking that any of the properties or attributes equals a desired value.</li>
<li>
<code>AttributeMatchClause</code>: A <code>MatchClause</code> for checking that an attribute equals a desired value.</li>
<li>
<code>TimeAttributeMatchClause</code>: A <code>MatchClause</code> for comparing a time attribute to a specified value.</li>
</ul>
<p>For every match clause, a desired value has to be supplied, as well as a comparison mode which can either be <code>eq</code> (equal to), <code>lte</code> (less than or equal to) or <code>gte</code> (greater than or equal to). Additionally, for a <code>PropertyMatchClause</code>, a property code has to be specified (possibilities can be enumerated with <code><a href="../reference/search_openbis.html">list_property_types()</a></code>), for an <code>AttributeMatchClause</code>, an attribute<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> and for a <code>TimeAttributeMatchClause</code>, a time attribute (either <code>registration_date</code> or <code>modification_date</code>).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">amb_kin &lt;-<span class="st"> </span><span class="kw"><a href="../reference/search_openbis.html">search_criteria</a></span>(<span class="kw"><a href="../reference/search_openbis.html">property_clause</a></span>(<span class="st">"library"</span>, <span class="st">"Ambion"</span>),</a>
<a class="sourceLine" id="cb5-2" title="2">                           <span class="kw"><a href="../reference/search_openbis.html">property_clause</a></span>(<span class="st">"geneset"</span>, <span class="st">"Kinome"</span>),</a>
<a class="sourceLine" id="cb5-3" title="3">                           <span class="dt">operator =</span> <span class="st">"all"</span>)</a>
<a class="sourceLine" id="cb5-4" title="4"></a>
<a class="sourceLine" id="cb5-5" title="5">ak_exps &lt;-<span class="st"> </span><span class="kw"><a href="../reference/search_openbis.html">search_openbis</a></span>(token, amb_kin,</a>
<a class="sourceLine" id="cb5-6" title="6">                          <span class="dt">target_object =</span> <span class="st">"experiment"</span>)</a>
<a class="sourceLine" id="cb5-7" title="7"></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(ak_exps, <span class="dt">length =</span> 15L)</a>
<a class="sourceLine" id="cb5-9" title="9"><span class="co">#&gt; ┌─█─Experiment </span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="co">#&gt; │ ├─permId = 20111223100933426-318017 </span></a>
<a class="sourceLine" id="cb5-11" title="11"><span class="co">#&gt; │ ├─code = ADENO-AU-K1 </span></a>
<a class="sourceLine" id="cb5-12" title="12"><span class="co">#&gt; │ ├─identifier = /INFECTX_PUBLISHED/ADENO_TEAM/ADENO-AU-K1 </span></a>
<a class="sourceLine" id="cb5-13" title="13"><span class="co">#&gt; │ ├─experimentTypeCode = SIRNA_HCS </span></a>
<a class="sourceLine" id="cb5-14" title="14"><span class="co">#&gt; │ ├─registrationDetails = █─EntityRegistrationDetails </span></a>
<a class="sourceLine" id="cb5-15" title="15"><span class="co">#&gt; │ │                       └─... </span></a>
<a class="sourceLine" id="cb5-16" title="16"><span class="co">#&gt; │ ├─properties = [GENESET = Kinome, REPLICATE = 1, LIBRARY = Ambion, DESCRIPT... </span></a>
<a class="sourceLine" id="cb5-17" title="17"><span class="co">#&gt; │ ├─metaprojects =  </span></a>
<a class="sourceLine" id="cb5-18" title="18"><span class="co">#&gt; │ ├─stub = FALSE </span></a>
<a class="sourceLine" id="cb5-19" title="19"><span class="co">#&gt; │ └─id = 153 </span></a>
<a class="sourceLine" id="cb5-20" title="20"><span class="co">#&gt; ├─█─Experiment </span></a>
<a class="sourceLine" id="cb5-21" title="21"><span class="co">#&gt; │ ├─permId = 20111223134014190-318046 </span></a>
<a class="sourceLine" id="cb5-22" title="22"><span class="co">#&gt; │ ├─code = ADENO-AU-K2 </span></a>
<a class="sourceLine" id="cb5-23" title="23"><span class="co">#&gt; ...</span></a>
<a class="sourceLine" id="cb5-24" title="24"><span class="kw"><a href="../reference/json_utils.html">get_field</a></span>(ak_exps, <span class="st">"code"</span>)</a>
<a class="sourceLine" id="cb5-25" title="25"><span class="co">#&gt;  [1] "ADENO-AU-K1"                   "ADENO-AU-K2"                  </span></a>
<a class="sourceLine" id="cb5-26" title="26"><span class="co">#&gt;  [3] "BARTONELLA-AU-K1-DBEPG-MOI400" "BARTONELLA-AU-K2-DBEPG-MOI400"</span></a>
<a class="sourceLine" id="cb5-27" title="27"><span class="co">#&gt;  [5] "BRUCELLA-AU-K1"                "BRUCELLA-AU-K2"               </span></a>
<a class="sourceLine" id="cb5-28" title="28"><span class="co">#&gt;  [7] "LISTERIA-AU-K1"                "LISTERIA-AU-K2"               </span></a>
<a class="sourceLine" id="cb5-29" title="29"><span class="co">#&gt;  [9] "LISTERIA-AU-K3"                "LISTERIA-AU-K4"               </span></a>
<a class="sourceLine" id="cb5-30" title="30"><span class="co">#&gt; [11] "RHINO-AU-K1"                   "RHINO-AU-K2"                  </span></a>
<a class="sourceLine" id="cb5-31" title="31"><span class="co">#&gt; [13] "SALMONELLA-AU-K1"              "SALMONELLA-AU-K2"             </span></a>
<a class="sourceLine" id="cb5-32" title="32"><span class="co">#&gt; [15] "SALMONELLA-AU-K3"              "SHIGELLA-AU-K1"               </span></a>
<a class="sourceLine" id="cb5-33" title="33"><span class="co">#&gt; [17] "SHIGELLA-AU-K2"                "VACCINIA-AU-K1"               </span></a>
<a class="sourceLine" id="cb5-34" title="34"><span class="co">#&gt; [19] "VACCINIA-AU-K2"</span></a></code></pre></div>
<p>In this example, openBIS is queried for all experiments that involve kinome-wide screens with Ambion libraries. First, a <code>SearchCriteria</code> object is created containing two property match clauses that both have to be met simultaneously. This <code>SearchCriteria</code> object is then passed to <code><a href="../reference/search_openbis.html">search_openbis()</a></code> along with the specification of a target type which can be either <code>data_set</code>, <code>experiment</code>, <code>material</code> or <code>sample</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">mtor_mat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/search_openbis.html">search_openbis</a></span>(</a>
<a class="sourceLine" id="cb6-2" title="2">  token,</a>
<a class="sourceLine" id="cb6-3" title="3">  <span class="kw"><a href="../reference/search_openbis.html">search_criteria</a></span>(<span class="kw"><a href="../reference/search_openbis.html">property_clause</a></span>(<span class="st">"gene_symbol"</span>, <span class="st">"MTOR"</span>)),</a>
<a class="sourceLine" id="cb6-4" title="4">  <span class="st">"material"</span></a>
<a class="sourceLine" id="cb6-5" title="5">)</a>
<a class="sourceLine" id="cb6-6" title="6"></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(mtor_mat, <span class="dt">depth =</span> 2L)</a>
<a class="sourceLine" id="cb6-8" title="8"><span class="co">#&gt; █─MaterialGeneric </span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="co">#&gt; ├─materialTypeIdentifier = █─MaterialTypeIdentifierGeneric </span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="co">#&gt; │                          └─materialTypeCode = GENE </span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="co">#&gt; ├─materialCode = 2475 </span></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="co">#&gt; ├─properties = [GENE_SYMBOL = MTOR, TRANSCRIPTOME_MSB_IN = false, PROTEOME_S... </span></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="co">#&gt; ├─materialProperties =  </span></a>
<a class="sourceLine" id="cb6-14" title="14"><span class="co">#&gt; ├─registrationDetails = █─EntityRegistrationDetails </span></a>
<a class="sourceLine" id="cb6-15" title="15"><span class="co">#&gt; │                       ├─userFirstName = Pauli </span></a>
<a class="sourceLine" id="cb6-16" title="16"><span class="co">#&gt; │                       ├─userLastName = Rämö </span></a>
<a class="sourceLine" id="cb6-17" title="17"><span class="co">#&gt; │                       ├─userEmail = pauli.ramo@unibas.ch </span></a>
<a class="sourceLine" id="cb6-18" title="18"><span class="co">#&gt; │                       ├─userId = pauli.ramo@unibas.ch </span></a>
<a class="sourceLine" id="cb6-19" title="19"><span class="co">#&gt; │                       ├─modifierFirstName =  </span></a>
<a class="sourceLine" id="cb6-20" title="20"><span class="co">#&gt; │                       ├─modifierLastName =  </span></a>
<a class="sourceLine" id="cb6-21" title="21"><span class="co">#&gt; │                       ├─modifierEmail =  </span></a>
<a class="sourceLine" id="cb6-22" title="22"><span class="co">#&gt; │                       ├─modifierUserId =  </span></a>
<a class="sourceLine" id="cb6-23" title="23"><span class="co">#&gt; │                       ├─registrationDate = 1346165996015 </span></a>
<a class="sourceLine" id="cb6-24" title="24"><span class="co">#&gt; │                       ├─modificationDate = 1400056232537 </span></a>
<a class="sourceLine" id="cb6-25" title="25"><span class="co">#&gt; │                       └─accessTimestamp =  </span></a>
<a class="sourceLine" id="cb6-26" title="26"><span class="co">#&gt; ├─metaprojects =  </span></a>
<a class="sourceLine" id="cb6-27" title="27"><span class="co">#&gt; └─id = 150409</span></a>
<a class="sourceLine" id="cb6-28" title="28"></a>
<a class="sourceLine" id="cb6-29" title="29">well_refs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/list_datasets.html">list_references</a></span>(token, mtor_mat, ak_exps[[1L]])</a>
<a class="sourceLine" id="cb6-30" title="30"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(well_refs, <span class="dt">length =</span> 15L)</a>
<a class="sourceLine" id="cb6-31" title="31"><span class="co">#&gt; ┌─█─PlateWellReferenceWithDatasets </span></a>
<a class="sourceLine" id="cb6-32" title="32"><span class="co">#&gt; │ ├─experimentPlateIdentifier = █─Plate </span></a>
<a class="sourceLine" id="cb6-33" title="33"><span class="co">#&gt; │ │                             └─... </span></a>
<a class="sourceLine" id="cb6-34" title="34"><span class="co">#&gt; │ ├─wellPosition = █─WellPosition </span></a>
<a class="sourceLine" id="cb6-35" title="35"><span class="co">#&gt; │ │                └─... </span></a>
<a class="sourceLine" id="cb6-36" title="36"><span class="co">#&gt; │ ├─imageDatasetReferences = █─ImageDatasetReference </span></a>
<a class="sourceLine" id="cb6-37" title="37"><span class="co">#&gt; │ │                          └─... </span></a>
<a class="sourceLine" id="cb6-38" title="38"><span class="co">#&gt; │ └─featureVectorDatasetReferences = ... </span></a>
<a class="sourceLine" id="cb6-39" title="39"><span class="co">#&gt; ├─█─PlateWellReferenceWithDatasets </span></a>
<a class="sourceLine" id="cb6-40" title="40"><span class="co">#&gt; │ ├─experimentPlateIdentifier = █─Plate </span></a>
<a class="sourceLine" id="cb6-41" title="41"><span class="co">#&gt; │ │                             └─... </span></a>
<a class="sourceLine" id="cb6-42" title="42"><span class="co">#&gt; │ ├─wellPosition = █─WellPosition </span></a>
<a class="sourceLine" id="cb6-43" title="43"><span class="co">#&gt; │ │                └─... </span></a>
<a class="sourceLine" id="cb6-44" title="44"><span class="co">#&gt; │ ├─imageDatasetReferences = █─ImageDatasetReference </span></a>
<a class="sourceLine" id="cb6-45" title="45"><span class="co">#&gt; ...</span></a></code></pre></div>
<p>A second example for a query, this time for a material object is given above. The search is constructed such that the returned object represents a compound targeting the gene <a href="https://www.ncbi.nlm.nih.gov/gene/2475"><code>MTOR</code></a>. This <code>MaterialGeneric</code> object then can be used to list wells on plates, involving this compound using the function <code><a href="../reference/list_datasets.html">list_references()</a></code>. The inverse of this, where for a given plate object all used materials are listed with associated wells, can be achieved using the function <code><a href="../reference/list_material.html">list_material()</a></code>.</p>
</div>
<div id="retrieving-openbis-data-resources" class="section level2">
<h2 class="hasAnchor">
<a href="#retrieving-openbis-data-resources" class="anchor"></a>Retrieving openBIS data resources</h2>
<p>Three different types of data resources are available from openBIS: The most straightforward is <code>files</code>. As explained above, each data set contains a set of files, for each of which a download url can be created using <code><a href="../reference/list_urls.html">list_download_urls()</a></code>. As this openBIS instance is hosting image-based HTS data, a second available data resource is <code>images</code>. Raw images can be retrieved as files in a <code>HCS_IMAGE_CONTAINER_RAW</code> data set but in addition to that, openBIS can be queried for specific images, instead of the plate-wise access provided by the data set route, and is able to serve transformations of raw images. A final type of data resource is <code>features</code>. This data is also available as files in a data set but similar to images is treated specially by openBIS in order to allow fine-grained queries.</p>
<div id="file-download" class="section level3">
<h3 class="hasAnchor">
<a href="#file-download" class="anchor"></a>File download</h3>
<p>The following example demonstrates how InfectX single cell feature data, calculated by CellProfiler, can be accessed. First a search for data sets of type <code>HCS_ANALYSIS_CELL_FEATURES_CC_MAT</code> is carried out. This search is limited to the <code>ADENO-AU-K1</code> experiment, using a <code>search_sub_criteria</code> object. One of the resulting data sets is then passed to <code><a href="../reference/list_fetch_files.html">fetch_files()</a></code> together with a regular expression to filter the list of available files (several hundred feature files are typically available for such data sets). The function <code><a href="../reference/list_fetch_files.html">read_mat_files()</a></code> is passed as <code>reader</code> argument and reads the binary Matlab files using <code><a href="https://rdrr.io/pkg/R.matlab/man/readMat.html">R.matlab::readMat()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">adeno_au_sub &lt;-<span class="st"> </span><span class="kw"><a href="../reference/search_openbis.html">search_sub_criteria</a></span>(</a>
<a class="sourceLine" id="cb7-2" title="2">  <span class="kw"><a href="../reference/search_openbis.html">search_criteria</a></span>(</a>
<a class="sourceLine" id="cb7-3" title="3">    <span class="kw"><a href="../reference/search_openbis.html">property_clause</a></span>(<span class="st">"pathogen"</span>, <span class="st">"Adenovirus"</span>),</a>
<a class="sourceLine" id="cb7-4" title="4">    <span class="kw"><a href="../reference/search_openbis.html">property_clause</a></span>(<span class="st">"library"</span>, <span class="st">"Ambion"</span>),</a>
<a class="sourceLine" id="cb7-5" title="5">    <span class="kw"><a href="../reference/search_openbis.html">property_clause</a></span>(<span class="st">"geneset"</span>, <span class="st">"Kinome"</span>),</a>
<a class="sourceLine" id="cb7-6" title="6">    <span class="kw"><a href="../reference/search_openbis.html">property_clause</a></span>(<span class="st">"replicate"</span>, 1L)</a>
<a class="sourceLine" id="cb7-7" title="7">  ),</a>
<a class="sourceLine" id="cb7-8" title="8">  <span class="dt">type =</span> <span class="st">"experiment"</span></a>
<a class="sourceLine" id="cb7-9" title="9">)</a>
<a class="sourceLine" id="cb7-10" title="10"></a>
<a class="sourceLine" id="cb7-11" title="11">adeno_au_mat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/search_openbis.html">search_criteria</a></span>(</a>
<a class="sourceLine" id="cb7-12" title="12">  <span class="kw"><a href="../reference/search_openbis.html">attribute_clause</a></span>(<span class="st">"type"</span>, <span class="st">"HCS_ANALYSIS_CELL_FEATURES_CC_MAT"</span>),</a>
<a class="sourceLine" id="cb7-13" title="13">  <span class="dt">sub_criteria =</span> adeno_au_sub</a>
<a class="sourceLine" id="cb7-14" title="14">)</a>
<a class="sourceLine" id="cb7-15" title="15"></a>
<a class="sourceLine" id="cb7-16" title="16">cell_ds &lt;-<span class="st"> </span><span class="kw"><a href="../reference/search_openbis.html">search_openbis</a></span>(token, adeno_au_mat,</a>
<a class="sourceLine" id="cb7-17" title="17">                          <span class="dt">target_object =</span> <span class="st">"data_set"</span>)</a>
<a class="sourceLine" id="cb7-18" title="18"></a>
<a class="sourceLine" id="cb7-19" title="19"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(cell_ds, <span class="dt">length =</span> 30L)</a>
<a class="sourceLine" id="cb7-20" title="20"><span class="co">#&gt; ┌─█─DataSet </span></a>
<a class="sourceLine" id="cb7-21" title="21"><span class="co">#&gt; │ ├─code = 20120629071528402-603231 </span></a>
<a class="sourceLine" id="cb7-22" title="22"><span class="co">#&gt; │ ├─experimentIdentifier = /INFECTX_PUBLISHED/ADENO_TEAM/ADENO-AU-K1 </span></a>
<a class="sourceLine" id="cb7-23" title="23"><span class="co">#&gt; │ ├─sampleIdentifierOrNull = /INFECTX_PUBLISHED/KB2-03-1I </span></a>
<a class="sourceLine" id="cb7-24" title="24"><span class="co">#&gt; │ ├─dataSetTypeCode = HCS_ANALYSIS_CELL_FEATURES_CC_MAT </span></a>
<a class="sourceLine" id="cb7-25" title="25"><span class="co">#&gt; │ ├─containerDataSet = FALSE </span></a>
<a class="sourceLine" id="cb7-26" title="26"><span class="co">#&gt; │ ├─linkDataSet = FALSE </span></a>
<a class="sourceLine" id="cb7-27" title="27"><span class="co">#&gt; │ ├─storageConfirmed = TRUE </span></a>
<a class="sourceLine" id="cb7-28" title="28"><span class="co">#&gt; │ ├─externalDataSetCode =  </span></a>
<a class="sourceLine" id="cb7-29" title="29"><span class="co">#&gt; │ ├─externalDataSetLink =  </span></a>
<a class="sourceLine" id="cb7-30" title="30"><span class="co">#&gt; │ ├─externalDataManagementSystem =  </span></a>
<a class="sourceLine" id="cb7-31" title="31"><span class="co">#&gt; │ ├─properties = [IBRAIN2.MODULE.ORDER = 7, IBRAIN2.WORKFLOW.NAME = AdenoShdC... </span></a>
<a class="sourceLine" id="cb7-32" title="32"><span class="co">#&gt; │ ├─metaprojects =  </span></a>
<a class="sourceLine" id="cb7-33" title="33"><span class="co">#&gt; │ ├─retrievedConnections =  </span></a>
<a class="sourceLine" id="cb7-34" title="34"><span class="co">#&gt; │ ├─parentCodes =  </span></a>
<a class="sourceLine" id="cb7-35" title="35"><span class="co">#&gt; │ ├─childrenCodes =  </span></a>
<a class="sourceLine" id="cb7-36" title="36"><span class="co">#&gt; │ ├─containedDataSets =  </span></a>
<a class="sourceLine" id="cb7-37" title="37"><span class="co">#&gt; │ ├─containerOrNull =  </span></a>
<a class="sourceLine" id="cb7-38" title="38"><span class="co">#&gt; │ ├─registrationDetails = █─EntityRegistrationDetails </span></a>
<a class="sourceLine" id="cb7-39" title="39"><span class="co">#&gt; │ │                       └─... </span></a>
<a class="sourceLine" id="cb7-40" title="40"><span class="co">#&gt; │ ├─fetchOptions =  </span></a>
<a class="sourceLine" id="cb7-41" title="41"><span class="co">#&gt; │ ├─postRegistered = TRUE </span></a>
<a class="sourceLine" id="cb7-42" title="42"><span class="co">#&gt; │ ├─stub = FALSE </span></a>
<a class="sourceLine" id="cb7-43" title="43"><span class="co">#&gt; │ └─id = 70463 </span></a>
<a class="sourceLine" id="cb7-44" title="44"><span class="co">#&gt; ├─█─DataSet </span></a>
<a class="sourceLine" id="cb7-45" title="45"><span class="co">#&gt; │ ├─code = 20120629075649478-603327 </span></a>
<a class="sourceLine" id="cb7-46" title="46"><span class="co">#&gt; │ ├─experimentIdentifier = /INFECTX_PUBLISHED/ADENO_TEAM/ADENO-AU-K1 </span></a>
<a class="sourceLine" id="cb7-47" title="47"><span class="co">#&gt; │ ├─sampleIdentifierOrNull = /INFECTX_PUBLISHED/KB2-02-1I </span></a>
<a class="sourceLine" id="cb7-48" title="48"><span class="co">#&gt; │ ├─dataSetTypeCode = HCS_ANALYSIS_CELL_FEATURES_CC_MAT </span></a>
<a class="sourceLine" id="cb7-49" title="49"><span class="co">#&gt; ...</span></a>
<a class="sourceLine" id="cb7-50" title="50"><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(cell_ds)</a>
<a class="sourceLine" id="cb7-51" title="51"><span class="co">#&gt; [1] 7</span></a>
<a class="sourceLine" id="cb7-52" title="52"></a>
<a class="sourceLine" id="cb7-53" title="53">dat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/list_fetch_files.html">fetch_files</a></span>(token, cell_ds[[1L]],</a>
<a class="sourceLine" id="cb7-54" title="54">                   <span class="dt">file_regex =</span> <span class="st">"Image</span><span class="ch">\\</span><span class="st">.Count_"</span>,</a>
<a class="sourceLine" id="cb7-55" title="55">                   <span class="dt">reader =</span> read_mat_files)</a>
<a class="sourceLine" id="cb7-56" title="56"></a>
<a class="sourceLine" id="cb7-57" title="57"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(dat) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(dat, attr, <span class="st">"feature"</span>)</a>
<a class="sourceLine" id="cb7-58" title="58">dat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(dat, as.integer)</a>
<a class="sourceLine" id="cb7-59" title="59"></a>
<a class="sourceLine" id="cb7-60" title="60">tibble<span class="op">::</span><span class="kw"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(dat, unlist))</a>
<a class="sourceLine" id="cb7-61" title="61"><span class="co">#&gt; # A tibble: 3,456 x 4</span></a>
<a class="sourceLine" id="cb7-62" title="62"><span class="co">#&gt;    Count_PeriNuclei Count_Nuclei Count_ExpandedNuclei Count_Cells</span></a>
<a class="sourceLine" id="cb7-63" title="63"><span class="co">#&gt;               &lt;int&gt;        &lt;int&gt;                &lt;int&gt;       &lt;int&gt;</span></a>
<a class="sourceLine" id="cb7-64" title="64"><span class="co">#&gt;  1              330          330                  330         330</span></a>
<a class="sourceLine" id="cb7-65" title="65"><span class="co">#&gt;  2              299          299                  299         299</span></a>
<a class="sourceLine" id="cb7-66" title="66"><span class="co">#&gt;  3              278          278                  278         278</span></a>
<a class="sourceLine" id="cb7-67" title="67"><span class="co">#&gt;  4              266          266                  266         266</span></a>
<a class="sourceLine" id="cb7-68" title="68"><span class="co">#&gt;  5              215          215                  215         215</span></a>
<a class="sourceLine" id="cb7-69" title="69"><span class="co">#&gt;  6              150          150                  150         150</span></a>
<a class="sourceLine" id="cb7-70" title="70"><span class="co">#&gt;  7              348          348                  348         348</span></a>
<a class="sourceLine" id="cb7-71" title="71"><span class="co">#&gt;  8              184          184                  184         184</span></a>
<a class="sourceLine" id="cb7-72" title="72"><span class="co">#&gt;  9              147          147                  147         147</span></a>
<a class="sourceLine" id="cb7-73" title="73"><span class="co">#&gt; 10              405          405                  405         405</span></a>
<a class="sourceLine" id="cb7-74" title="74"><span class="co">#&gt; # … with 3,446 more rows</span></a></code></pre></div>
<p>For each file, <code><a href="../reference/list_fetch_files.html">read_mat_files()</a></code> will return a list with one entry per imaging site. For this data set, there are 9 imaging sites per well which yields 3456 sites for the entire plate. Additionally, <code><a href="../reference/list_fetch_files.html">fetch_files()</a></code> returns a list structure per request, containing information on which request corresponds to which data set and file. This is necessary because <code><a href="../reference/list_fetch_files.html">fetch_files()</a></code> could be called on several data sets at once, each returning multiple files.</p>
<p>As a second example, area features are requested. For the given screen, area measurements are available for the three object types <code>PeriNuclei</code>, <code>Nuclei</code> and <code>Cells</code>. Unlike in the previous example, where a scalar corresponds to each well, here the variables are vector-valued per well. Therefore we need to create a column <code>Well</code>, indicating which rows correspond to which wells. Well indices are linearized in row-major fashion with respect to the plate layout.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">dat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/list_fetch_files.html">fetch_files</a></span>(token, cell_ds[[1L]],</a>
<a class="sourceLine" id="cb8-2" title="2">                   <span class="dt">file_regex =</span> <span class="st">"AreaShape_Area"</span>,</a>
<a class="sourceLine" id="cb8-3" title="3">                   <span class="dt">reader =</span> read_mat_files)</a>
<a class="sourceLine" id="cb8-4" title="4"></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="kw"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span>(dat[[1L]])</a>
<a class="sourceLine" id="cb8-6" title="6"><span class="co">#&gt; $object</span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="co">#&gt; [1] "PeriNuclei"</span></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="co">#&gt; $feature</span></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="co">#&gt; [1] "AreaShape_Area"</span></a>
<a class="sourceLine" id="cb8-11" title="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-12" title="12"><span class="co">#&gt; $data_set</span></a>
<a class="sourceLine" id="cb8-13" title="13"><span class="co">#&gt; [1] "20120629071528402-603231"</span></a>
<a class="sourceLine" id="cb8-14" title="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-15" title="15"><span class="co">#&gt; $file</span></a>
<a class="sourceLine" id="cb8-16" title="16"><span class="co">#&gt; █─FileInfoDssDTO </span></a>
<a class="sourceLine" id="cb8-17" title="17"><span class="co">#&gt; ├─pathInDataSet = original/ibrain2_dataset_id_52954/PeriNuclei.AreaShape_Are... </span></a>
<a class="sourceLine" id="cb8-18" title="18"><span class="co">#&gt; ├─pathInListing = original/ibrain2_dataset_id_52954/PeriNuclei.AreaShape_Are... </span></a>
<a class="sourceLine" id="cb8-19" title="19"><span class="co">#&gt; ├─isDirectory = FALSE </span></a>
<a class="sourceLine" id="cb8-20" title="20"><span class="co">#&gt; ├─crc32Checksum =  </span></a>
<a class="sourceLine" id="cb8-21" title="21"><span class="co">#&gt; └─fileSize = 906623</span></a>
<a class="sourceLine" id="cb8-22" title="22"></a>
<a class="sourceLine" id="cb8-23" title="23"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(dat) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"Area_"</span>, <span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(dat, attr, <span class="st">"object"</span>))</a>
<a class="sourceLine" id="cb8-24" title="24">well_names &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(LETTERS[1L<span class="op">:</span>16L], <span class="dt">each =</span> 24L), <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(1L<span class="op">:</span>24L, 16L))</a>
<a class="sourceLine" id="cb8-25" title="25">well_names &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(well_names, <span class="dt">each =</span> 9L), <span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(dat[[1L]], length))</a>
<a class="sourceLine" id="cb8-26" title="26"></a>
<a class="sourceLine" id="cb8-27" title="27">dat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(dat, unlist)</a>
<a class="sourceLine" id="cb8-28" title="28"></a>
<a class="sourceLine" id="cb8-29" title="29">tibble<span class="op">::</span><span class="kw"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">Well =</span> well_names), <span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(dat, as.integer)))</a>
<a class="sourceLine" id="cb8-30" title="30"><span class="co">#&gt; # A tibble: 548,116 x 4</span></a>
<a class="sourceLine" id="cb8-31" title="31"><span class="co">#&gt;    Well  Area_PeriNuclei Area_Nuclei Area_Cells</span></a>
<a class="sourceLine" id="cb8-32" title="32"><span class="co">#&gt;    &lt;chr&gt;           &lt;int&gt;       &lt;int&gt;      &lt;int&gt;</span></a>
<a class="sourceLine" id="cb8-33" title="33"><span class="co">#&gt;  1 A1                696         763       1670</span></a>
<a class="sourceLine" id="cb8-34" title="34"><span class="co">#&gt;  2 A1                539         765       1652</span></a>
<a class="sourceLine" id="cb8-35" title="35"><span class="co">#&gt;  3 A1                650         819       2558</span></a>
<a class="sourceLine" id="cb8-36" title="36"><span class="co">#&gt;  4 A1                364         413       2289</span></a>
<a class="sourceLine" id="cb8-37" title="37"><span class="co">#&gt;  5 A1                494         731       2120</span></a>
<a class="sourceLine" id="cb8-38" title="38"><span class="co">#&gt;  6 A1                646         832       3015</span></a>
<a class="sourceLine" id="cb8-39" title="39"><span class="co">#&gt;  7 A1                564         469       2310</span></a>
<a class="sourceLine" id="cb8-40" title="40"><span class="co">#&gt;  8 A1                701         774       2055</span></a>
<a class="sourceLine" id="cb8-41" title="41"><span class="co">#&gt;  9 A1               1278        1924       3855</span></a>
<a class="sourceLine" id="cb8-42" title="42"><span class="co">#&gt; 10 A1                597         701       1806</span></a>
<a class="sourceLine" id="cb8-43" title="43"><span class="co">#&gt; # … with 548,106 more rows</span></a></code></pre></div>
<p>The resulting data matrix <span class="math inline">\(X\)</span> holds all measurements of a plate for the selected features and is structured as</p>
<p><span class="math display">\[X = \begin{bmatrix}
X_{G_1} \\
X_{G_2} \\
... \\
X_{G_m}
\end{bmatrix}
\]</span></p>
<p>where groups of rows <span class="math inline">\(X_{G_i}\)</span> are <span class="math inline">\(n_i \times p\)</span> matrices holding <span class="math inline">\(p\)</span> features as columns corresponding to <span class="math inline">\(n_i\)</span> single cell measurements under knock-down of gene <span class="math inline">\(G_i\)</span>.</p>
<p>Several attributes are set for each requested file. The <code><a href="../reference/list_fetch_files.html">read_mat_files()</a></code> function extracts object (what type of CellProfiler object the feature was calculated on) and feature information (what kind of CellProfiler measurement was performed) from the read file. In addition, <code><a href="../reference/list_fetch_files.html">fetch_files()</a></code> stores request information such as dataset and file in order for the user to match responses with requests.</p>
</div>
<div id="image-access" class="section level3">
<h3 class="hasAnchor">
<a href="#image-access" class="anchor"></a>Image access</h3>
<p>In order to fetch images, again first a search is constructed. Re-using the previous <code>search_sub_criteria</code>, the search is targeted at sample objects of type <code>PLATE</code>, as image data sets are connected to plates. To find the appropriate data set, the function <code><a href="../reference/list_datasets.html">list_references()</a></code> may be used and since the current target is fetching raw image data, the <code>type</code> argument of <code><a href="../reference/list_datasets.html">list_references()</a></code> can be left at default value. The returned <code>ImageDatasetReference</code> is then passed to <code><a href="../reference/list_fetch_images.html">list_image_metadata()</a></code> for some additional information on the image data set, mainly the available channels.</p>
<p>To narrow down the requested set of images, <code><a href="../reference/list_datasets.html">list_references()</a></code> is called again, this time on the <code>ImageDatasetReference</code> object and in conjunction with a <code>WellPosition</code> object. The returned set of <code>PlateImageReference</code> objects precisely specify a single image by containing information on image data set, well position, image tile and imaging channel. The <code>ImageDatasetReference</code> corresponding to the tile with index 0 is passed to <code><a href="../reference/list_fetch_images.html">fetch_images()</a></code>, yielding a single image. As <code><a href="../reference/list_fetch_images.html">fetch_images()</a></code> can be called on several objects specifying images, each request contributes an entry to the resulting list with some meta data attached as attributes.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">adeno_au_samp &lt;-<span class="st"> </span><span class="kw"><a href="../reference/search_openbis.html">search_criteria</a></span>(</a>
<a class="sourceLine" id="cb9-2" title="2">  <span class="kw"><a href="../reference/search_openbis.html">attribute_clause</a></span>(<span class="st">"type"</span>, <span class="st">"PLATE"</span>),</a>
<a class="sourceLine" id="cb9-3" title="3">  <span class="dt">sub_criteria =</span> adeno_au_sub</a>
<a class="sourceLine" id="cb9-4" title="4">)</a>
<a class="sourceLine" id="cb9-5" title="5"></a>
<a class="sourceLine" id="cb9-6" title="6">samples &lt;-<span class="st"> </span><span class="kw"><a href="../reference/search_openbis.html">search_openbis</a></span>(token, adeno_au_samp,</a>
<a class="sourceLine" id="cb9-7" title="7">                          <span class="dt">target_object =</span> <span class="st">"sample"</span>)</a>
<a class="sourceLine" id="cb9-8" title="8"></a>
<a class="sourceLine" id="cb9-9" title="9">raw_ref &lt;-<span class="st"> </span><span class="kw"><a href="../reference/list_datasets.html">list_references</a></span>(token, samples[[2L]])</a>
<a class="sourceLine" id="cb9-10" title="10"></a>
<a class="sourceLine" id="cb9-11" title="11">img_meta &lt;-<span class="st"> </span><span class="kw"><a href="../reference/list_fetch_images.html">list_image_metadata</a></span>(token, raw_ref)</a>
<a class="sourceLine" id="cb9-12" title="12"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(img_meta)</a>
<a class="sourceLine" id="cb9-13" title="13"><span class="co">#&gt; █─ImageDatasetMetadata </span></a>
<a class="sourceLine" id="cb9-14" title="14"><span class="co">#&gt; ├─imageDataset = █─ImageDatasetReference </span></a>
<a class="sourceLine" id="cb9-15" title="15"><span class="co">#&gt; │                └─... </span></a>
<a class="sourceLine" id="cb9-16" title="16"><span class="co">#&gt; ├─channelNames = [CY5, DAPI, GFP] </span></a>
<a class="sourceLine" id="cb9-17" title="17"><span class="co">#&gt; ├─channelCodes = [CY5, DAPI, GFP] </span></a>
<a class="sourceLine" id="cb9-18" title="18"><span class="co">#&gt; ├─channelLabels = [Cy5, DAPI, GFP] </span></a>
<a class="sourceLine" id="cb9-19" title="19"><span class="co">#&gt; ├─channels = ... </span></a>
<a class="sourceLine" id="cb9-20" title="20"><span class="co">#&gt; ├─tilesRows = 3 </span></a>
<a class="sourceLine" id="cb9-21" title="21"><span class="co">#&gt; ├─tilesCols = 3 </span></a>
<a class="sourceLine" id="cb9-22" title="22"><span class="co">#&gt; ├─width = 1392 </span></a>
<a class="sourceLine" id="cb9-23" title="23"><span class="co">#&gt; ├─height = 1040 </span></a>
<a class="sourceLine" id="cb9-24" title="24"><span class="co">#&gt; ├─thumbnailWidth = 200 </span></a>
<a class="sourceLine" id="cb9-25" title="25"><span class="co">#&gt; ├─thumbnailHeight = 149 </span></a>
<a class="sourceLine" id="cb9-26" title="26"><span class="co">#&gt; ├─numberOfChannels = 3 </span></a>
<a class="sourceLine" id="cb9-27" title="27"><span class="co">#&gt; └─numberOfTiles = 9</span></a>
<a class="sourceLine" id="cb9-28" title="28"></a>
<a class="sourceLine" id="cb9-29" title="29">well_raw &lt;-<span class="st"> </span><span class="kw"><a href="../reference/list_datasets.html">list_references</a></span>(token, raw_ref,</a>
<a class="sourceLine" id="cb9-30" title="30">                            <span class="dt">wells =</span> <span class="kw"><a href="../reference/list_plate_well.html">well_pos</a></span>(<span class="dt">name =</span> <span class="st">"A2"</span>),</a>
<a class="sourceLine" id="cb9-31" title="31">                            <span class="dt">channel =</span> img_meta[[<span class="st">"channelCodes"</span>]][[1L]])</a>
<a class="sourceLine" id="cb9-32" title="32"></a>
<a class="sourceLine" id="cb9-33" title="33"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(well_raw, <span class="dt">depth =</span> 2L, <span class="dt">length =</span> 15L)</a>
<a class="sourceLine" id="cb9-34" title="34"><span class="co">#&gt; ┌─█─PlateImageReference </span></a>
<a class="sourceLine" id="cb9-35" title="35"><span class="co">#&gt; │ ├─datasetCode = 20111223104040841-318025 </span></a>
<a class="sourceLine" id="cb9-36" title="36"><span class="co">#&gt; │ ├─datastoreServerUrl = https://infectx.biozentrum.unibas.ch </span></a>
<a class="sourceLine" id="cb9-37" title="37"><span class="co">#&gt; │ ├─wellPosition = █─WellPosition </span></a>
<a class="sourceLine" id="cb9-38" title="38"><span class="co">#&gt; │ │                ├─wellRow = 1 </span></a>
<a class="sourceLine" id="cb9-39" title="39"><span class="co">#&gt; │ │                └─wellColumn = 2 </span></a>
<a class="sourceLine" id="cb9-40" title="40"><span class="co">#&gt; │ ├─tile = 0 </span></a>
<a class="sourceLine" id="cb9-41" title="41"><span class="co">#&gt; │ ├─channel = CY5 </span></a>
<a class="sourceLine" id="cb9-42" title="42"><span class="co">#&gt; │ └─permId = 20111223104040841-318025 </span></a>
<a class="sourceLine" id="cb9-43" title="43"><span class="co">#&gt; ├─█─PlateImageReference </span></a>
<a class="sourceLine" id="cb9-44" title="44"><span class="co">#&gt; │ ├─datasetCode = 20111223104040841-318025 </span></a>
<a class="sourceLine" id="cb9-45" title="45"><span class="co">#&gt; │ ├─datastoreServerUrl = https://infectx.biozentrum.unibas.ch </span></a>
<a class="sourceLine" id="cb9-46" title="46"><span class="co">#&gt; │ ├─wellPosition = █─WellPosition </span></a>
<a class="sourceLine" id="cb9-47" title="47"><span class="co">#&gt; │ │                ├─wellRow = 1 </span></a>
<a class="sourceLine" id="cb9-48" title="48"><span class="co">#&gt; ...</span></a>
<a class="sourceLine" id="cb9-49" title="49"></a>
<a class="sourceLine" id="cb9-50" title="50">raw_img &lt;-<span class="st"> </span><span class="kw"><a href="../reference/list_fetch_images.html">fetch_images</a></span>(token, well_raw[[2L]],</a>
<a class="sourceLine" id="cb9-51" title="51">                        <span class="dt">image_size =</span> <span class="kw"><a href="../reference/json_class.html">json_class</a></span>(<span class="dt">width =</span> 600L,</a>
<a class="sourceLine" id="cb9-52" title="52">                                                <span class="dt">height =</span> 600L,</a>
<a class="sourceLine" id="cb9-53" title="53">                                                <span class="dt">class =</span> <span class="st">"ImageSize"</span>))</a>
<a class="sourceLine" id="cb9-54" title="54"></a>
<a class="sourceLine" id="cb9-55" title="55"><span class="kw"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span>(raw_img[[1L]])</a>
<a class="sourceLine" id="cb9-56" title="56"><span class="co">#&gt; $class</span></a>
<a class="sourceLine" id="cb9-57" title="57"><span class="co">#&gt; [1] "magick-image"</span></a>
<a class="sourceLine" id="cb9-58" title="58"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-59" title="59"><span class="co">#&gt; $data_set</span></a>
<a class="sourceLine" id="cb9-60" title="60"><span class="co">#&gt; █─PlateImageReference </span></a>
<a class="sourceLine" id="cb9-61" title="61"><span class="co">#&gt; ├─datasetCode = 20111223104040841-318025 </span></a>
<a class="sourceLine" id="cb9-62" title="62"><span class="co">#&gt; ├─datastoreServerUrl = https://infectx.biozentrum.unibas.ch </span></a>
<a class="sourceLine" id="cb9-63" title="63"><span class="co">#&gt; ├─wellPosition = █─WellPosition </span></a>
<a class="sourceLine" id="cb9-64" title="64"><span class="co">#&gt; │                └─... </span></a>
<a class="sourceLine" id="cb9-65" title="65"><span class="co">#&gt; ├─tile = 1 </span></a>
<a class="sourceLine" id="cb9-66" title="66"><span class="co">#&gt; ├─channel = CY5 </span></a>
<a class="sourceLine" id="cb9-67" title="67"><span class="co">#&gt; └─permId = 20111223104040841-318025</span></a>
<a class="sourceLine" id="cb9-68" title="68"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(raw_img[[1L]])</a>
<a class="sourceLine" id="cb9-69" title="69"><span class="co">#&gt; # A tibble: 1 x 7</span></a>
<a class="sourceLine" id="cb9-70" title="70"><span class="co">#&gt;   format width height colorspace matte filesize density</span></a>
<a class="sourceLine" id="cb9-71" title="71"><span class="co">#&gt;   &lt;chr&gt;  &lt;int&gt;  &lt;int&gt; &lt;chr&gt;      &lt;lgl&gt;    &lt;int&gt; &lt;chr&gt;  </span></a>
<a class="sourceLine" id="cb9-72" title="72"><span class="co">#&gt; 1 PNG      600    448 Gray       FALSE   269740 72x72</span></a></code></pre></div>
<p><img src="infx-intro_files/figure-html/fetch-images-1.png" style="display: block; margin: auto;"></p>
<p>As further illustration of the capabilities of the openBIS API, the following example combines the previously fetched image with a segmentation mask for cells. The same sample object from above is again passed to <code><a href="../reference/list_datasets.html">list_references()</a></code> but this time an <code>ImageDatasetReference</code> object corresponding to an image segmentation dataset is retrieved. Again using <code><a href="../reference/list_fetch_images.html">list_image_metadata()</a></code>, the available channels are listed and using this information, a request for the image segmentation masks for the desired well and image tile is issued.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">segm_ref &lt;-<span class="st"> </span><span class="kw"><a href="../reference/list_datasets.html">list_references</a></span>(token, samples[[2L]],</a>
<a class="sourceLine" id="cb10-2" title="2">                            <span class="dt">type =</span> <span class="st">"segmentation"</span>)</a>
<a class="sourceLine" id="cb10-3" title="3"></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="kw"><a href="../reference/list_fetch_images.html">list_image_metadata</a></span>(token, segm_ref)</a>
<a class="sourceLine" id="cb10-5" title="5"><span class="co">#&gt; █─ImageDatasetMetadata </span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="co">#&gt; ├─imageDataset = █─ImageDatasetReference </span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="co">#&gt; │                └─... </span></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="co">#&gt; ├─channelNames = [CELLS__CY5_, NUCLEI__DAPI_, PERINUCLEI__DAPI_] </span></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="co">#&gt; ├─channelCodes = [CELLS__CY5_, NUCLEI__DAPI_, PERINUCLEI__DAPI_] </span></a>
<a class="sourceLine" id="cb10-10" title="10"><span class="co">#&gt; ├─channelLabels = [Cells (Cy5), Nuclei (DAPI), PeriNuclei (DAPI)] </span></a>
<a class="sourceLine" id="cb10-11" title="11"><span class="co">#&gt; ├─channels = ... </span></a>
<a class="sourceLine" id="cb10-12" title="12"><span class="co">#&gt; ├─tilesRows = 3 </span></a>
<a class="sourceLine" id="cb10-13" title="13"><span class="co">#&gt; ├─tilesCols = 3 </span></a>
<a class="sourceLine" id="cb10-14" title="14"><span class="co">#&gt; ├─width = 1392 </span></a>
<a class="sourceLine" id="cb10-15" title="15"><span class="co">#&gt; ├─height = 1040 </span></a>
<a class="sourceLine" id="cb10-16" title="16"><span class="co">#&gt; ├─thumbnailWidth = 200 </span></a>
<a class="sourceLine" id="cb10-17" title="17"><span class="co">#&gt; ├─thumbnailHeight = 149 </span></a>
<a class="sourceLine" id="cb10-18" title="18"><span class="co">#&gt; ├─numberOfChannels = 3 </span></a>
<a class="sourceLine" id="cb10-19" title="19"><span class="co">#&gt; └─numberOfTiles = 9</span></a>
<a class="sourceLine" id="cb10-20" title="20"></a>
<a class="sourceLine" id="cb10-21" title="21">well_segm &lt;-<span class="st"> </span><span class="kw"><a href="../reference/list_datasets.html">list_references</a></span>(token, segm_ref,</a>
<a class="sourceLine" id="cb10-22" title="22">                             <span class="dt">wells =</span> <span class="kw"><a href="../reference/list_plate_well.html">well_pos</a></span>(<span class="dt">name =</span> <span class="st">"A2"</span>),</a>
<a class="sourceLine" id="cb10-23" title="23">                             <span class="dt">channel =</span> <span class="st">"CELLS__CY5_"</span>)</a>
<a class="sourceLine" id="cb10-24" title="24"></a>
<a class="sourceLine" id="cb10-25" title="25">segm_img &lt;-<span class="st"> </span><span class="kw"><a href="../reference/list_fetch_images.html">fetch_images</a></span>(token, well_segm[[2L]],</a>
<a class="sourceLine" id="cb10-26" title="26">                         <span class="dt">image_size =</span> <span class="kw"><a href="../reference/json_class.html">json_class</a></span>(<span class="dt">width =</span> 600L,</a>
<a class="sourceLine" id="cb10-27" title="27">                                                 <span class="dt">height =</span> 600L,</a>
<a class="sourceLine" id="cb10-28" title="28">                                                 <span class="dt">class =</span> <span class="st">"ImageSize"</span>))</a>
<a class="sourceLine" id="cb10-29" title="29"></a>
<a class="sourceLine" id="cb10-30" title="30">cells &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(raw_img[[1L]], magick<span class="op">::</span><span class="kw"><a href="https://docs.ropensci.org/magick/reference/color.html">image_transparent</a></span>(segm_img[[1L]], <span class="st">"black"</span>))</a>
<a class="sourceLine" id="cb10-31" title="31"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(magick<span class="op">::</span><span class="kw"><a href="https://docs.ropensci.org/magick/reference/animation.html">image_mosaic</a></span>(cells))</a>
<a class="sourceLine" id="cb10-32" title="32"><span class="co">#&gt; # A tibble: 1 x 7</span></a>
<a class="sourceLine" id="cb10-33" title="33"><span class="co">#&gt;   format width height colorspace matte filesize density</span></a>
<a class="sourceLine" id="cb10-34" title="34"><span class="co">#&gt;   &lt;chr&gt;  &lt;int&gt;  &lt;int&gt; &lt;chr&gt;      &lt;lgl&gt;    &lt;int&gt; &lt;chr&gt;  </span></a>
<a class="sourceLine" id="cb10-35" title="35"><span class="co">#&gt; 1 PNG      600    448 sRGB       FALSE        0 72x72</span></a></code></pre></div>
<p><img src="infx-intro_files/figure-html/fetch-mask-1.png" style="display: block; margin: auto;"></p>
<p>Note that in order to create a usable segmentation mask, the black background of the segmentation data set has to be made transparent using <code><a href="https://docs.ropensci.org/magick/reference/color.html">magick::image_transparent()</a></code>. Only after applying this transformation, can the segmentation mask be placed on top of the microscopy image.</p>
</div>
<div id="openbis-feature-data" class="section level3">
<h3 class="hasAnchor">
<a href="#openbis-feature-data" class="anchor"></a>OpenBIS feature data</h3>
<p>The third type of openBIS data resources are files treated as feature data sets. As such, these can be queried similarly to images. Again using the plate sample object from the previous search query, <code><a href="../reference/list_datasets.html">list_references()</a></code> with type specification set to <code>feature</code> will return <code>FeatureVectorDatasetReference</code> objects. Several types of feature data sets are available, each of which may contain several features. In order to list all features contained in a feature data set, the function <code><a href="../reference/list_fetch_features.html">list_features()</a></code> may be used. Finally, <code><a href="../reference/list_fetch_features.html">fetch_features()</a></code> will return the requested feature data for the specified plates or wells as <code>FeatureVectorDataset</code> object. This in turn contains a list of <code>FeatureVector</code> objects, each of which holds feature information for a single well.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">feat_ref &lt;-<span class="st"> </span><span class="kw"><a href="../reference/list_datasets.html">list_references</a></span>(token, samples[[2L]],</a>
<a class="sourceLine" id="cb11-2" title="2">                            <span class="dt">type =</span> <span class="st">"feature"</span>)</a>
<a class="sourceLine" id="cb11-3" title="3"><span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="kw"><a href="../reference/json_utils.html">get_field</a></span>(feat_ref, <span class="st">"dataSetType"</span>))</a>
<a class="sourceLine" id="cb11-4" title="4"><span class="co">#&gt; [1] "HCS_ANALYSIS_WELL_RESULTS_SUMMARIES"                    </span></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="co">#&gt; [2] "HCS_ANALYSIS_CONTAINER_WELL_RESULTS_SUMMARIES"          </span></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="co">#&gt; [3] "HCS_ANALYSIS_CONTAINER_WELL_CLASSIFICATION_SUMMARIES"   </span></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="co">#&gt; [4] "HCS_ANALYSIS_WELL_THRESHOLDEDINFECTIONSCORING_SUMMARIES"</span></a>
<a class="sourceLine" id="cb11-8" title="8"></a>
<a class="sourceLine" id="cb11-9" title="9"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="../reference/list_fetch_features.html">list_features</a></span>(token, feat_ref[[1L]]), <span class="dt">length =</span> 10L)</a>
<a class="sourceLine" id="cb11-10" title="10"><span class="co">#&gt; ┌─█─FeatureInformation </span></a>
<a class="sourceLine" id="cb11-11" title="11"><span class="co">#&gt; │ ├─code = BARCODE </span></a>
<a class="sourceLine" id="cb11-12" title="12"><span class="co">#&gt; │ ├─label = Barcode </span></a>
<a class="sourceLine" id="cb11-13" title="13"><span class="co">#&gt; │ └─description = Barcode </span></a>
<a class="sourceLine" id="cb11-14" title="14"><span class="co">#&gt; ├─█─FeatureInformation </span></a>
<a class="sourceLine" id="cb11-15" title="15"><span class="co">#&gt; │ ├─code = COUNT_CELLS </span></a>
<a class="sourceLine" id="cb11-16" title="16"><span class="co">#&gt; │ ├─label = Count_Cells </span></a>
<a class="sourceLine" id="cb11-17" title="17"><span class="co">#&gt; │ └─description = Count_Cells </span></a>
<a class="sourceLine" id="cb11-18" title="18"><span class="co">#&gt; ├─█─FeatureInformation </span></a>
<a class="sourceLine" id="cb11-19" title="19"><span class="co">#&gt; ...</span></a>
<a class="sourceLine" id="cb11-20" title="20"></a>
<a class="sourceLine" id="cb11-21" title="21">cell_count &lt;-<span class="st"> </span><span class="kw"><a href="../reference/list_fetch_features.html">fetch_features</a></span>(token, feat_ref[[1L]], <span class="st">"COUNT_CELLS"</span>)</a>
<a class="sourceLine" id="cb11-22" title="22"></a>
<a class="sourceLine" id="cb11-23" title="23"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(cell_count)</a>
<a class="sourceLine" id="cb11-24" title="24"><span class="co">#&gt; █─FeatureVectorDataset </span></a>
<a class="sourceLine" id="cb11-25" title="25"><span class="co">#&gt; ├─dataset = █─FeatureVectorDatasetReference </span></a>
<a class="sourceLine" id="cb11-26" title="26"><span class="co">#&gt; │           └─... </span></a>
<a class="sourceLine" id="cb11-27" title="27"><span class="co">#&gt; ├─featureNames = [COUNT_CELLS] </span></a>
<a class="sourceLine" id="cb11-28" title="28"><span class="co">#&gt; ├─featureCodes = [COUNT_CELLS] </span></a>
<a class="sourceLine" id="cb11-29" title="29"><span class="co">#&gt; ├─featureLabels = [Count_Cells] </span></a>
<a class="sourceLine" id="cb11-30" title="30"><span class="co">#&gt; └─featureVectors = ...</span></a>
<a class="sourceLine" id="cb11-31" title="31"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(cell_count[[<span class="st">"featureVectors"</span>]], <span class="dt">depth =</span> 2L, <span class="dt">length =</span> 10L)</a>
<a class="sourceLine" id="cb11-32" title="32"><span class="co">#&gt; ┌─█─FeatureVector </span></a>
<a class="sourceLine" id="cb11-33" title="33"><span class="co">#&gt; │ ├─wellPosition = █─WellPosition </span></a>
<a class="sourceLine" id="cb11-34" title="34"><span class="co">#&gt; │ │                ├─wellRow = 1 </span></a>
<a class="sourceLine" id="cb11-35" title="35"><span class="co">#&gt; │ │                └─wellColumn = 1 </span></a>
<a class="sourceLine" id="cb11-36" title="36"><span class="co">#&gt; │ ├─values = [1027] </span></a>
<a class="sourceLine" id="cb11-37" title="37"><span class="co">#&gt; │ ├─vocabularyFeatureFlags = [FALSE] </span></a>
<a class="sourceLine" id="cb11-38" title="38"><span class="co">#&gt; │ └─vocabularyTerms = [NULL] </span></a>
<a class="sourceLine" id="cb11-39" title="39"><span class="co">#&gt; ├─█─FeatureVector </span></a>
<a class="sourceLine" id="cb11-40" title="40"><span class="co">#&gt; │ ├─wellPosition = █─WellPosition </span></a>
<a class="sourceLine" id="cb11-41" title="41"><span class="co">#&gt; ...</span></a></code></pre></div>
<p>Whenever feature data for an entire plate is fetched it might be more efficient to simply download the associated data set file, especially if several of the contained features are of interest. Such files are <code>.csv</code> formatted tables with columns corresponding to features and rows to wells. A convenient aspect of feature data is however that it can be queried per well. Passing the <code>FeatureVectorDatasetReference</code> object to <code><a href="../reference/list_datasets.html">list_references()</a></code> alongside a set of <code>WellPosition</code> objects will return <code>FeatureVectorDatasetWellReference</code> objects which can be used to retrieve subsetted feature information using <code><a href="../reference/list_fetch_features.html">fetch_features()</a></code>.</p>
<p>For illustration purposes, a heatmap of per-well cell counts, drawn with <code>ggplot::ggplot()</code>, is shown below. This is akin to the plate heatmaps that are shown in the openBIS web GUI.</p>
<p><img src="infx-intro_files/figure-html/heatmap-1.png" width="700" style="display: block; margin: auto;"></p>
<p>For the above example, a feature data set of type <code>HCS_ANALYSIS_WELL_RESULTS_SUMMARIES</code> was chosen. Such data sets contain per-well aggregated results from CellProfiler analysis, including object counts, mean area measurements and mean intensity measurements. Other feature data sets hold summarized information on infection scoring, quality metrics such as focus scores, underexposure/overexposure indicators, dynamic range analysis or image acquisition meta data.</p>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>possible values are <code>code</code>, <code>type</code>, <code>perm_id</code>, <code>space</code>, <code>project</code>, <code>project_perm_id</code>, <code>metaproject</code>, <code>registrator_user_id</code>, <code>registrator_first_name</code>, <code>registrator_last_name</code>, <code>registrator_email</code>, <code>modifier_user_id</code>, <code>modifier_first_name</code>, <code>modifier_last_name</code> or <code>modifier_email</code><a href="#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#organizational-concepts-in-openbis">Organizational concepts in openBIS</a></li>
      <li><a href="#searching-in-openbis">Searching in openBIS</a></li>
      <li><a href="#retrieving-openbis-data-resources">Retrieving openBIS data resources</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start bottom-8">
            <div class="col-xs-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-xs-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="http://github.com/ropensci" target="_blank"><div class="icon fab fa-github"></div></a>
                        <a href="http://github.com/ropenscilabs" target="_blank"><div class="icon fa fa-flask"></div></a>
                        <a href="http://twitter.com/ropensci" target="_blank"><div class="icon fab fa-twitter"></div></a>
                        <a href="http://vimeo.com/ropensci" target="_blank"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Info</h5>
                            <li><a href="https://ropensci.org/about">Mission</a></li>
                            <li><a href="https://ropensci.org/about#team">Team</a></li>
                            <li><a href="https://ropensci.org/about#collaborators">Collaborators</a></li>
                            <li><a href="https://ropensci.org/careers">Careers</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Work</h5>
                            <li><a href="https://ropensci.org/packages/">Packages</a></li>
                            <li><a href="https://ropensci.org/blog/">Blog</a></li>
                            <li><a href="https://ropensci.org/technotes/">Tech Notes</a></li>
                            <li><a href="https://ropensci.org/tutorials/">Tutorials</a></li>
                            <li><a href="https://ropensci.org/usecases/">Use Cases</a></li>
                            <li><a href="https://ropensci.org/resources/">More Resources</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Participate</h5>
                            <li><a href="https://ropensci.org/contact/">Contact us</a></li>
                            <li><a href="https://ropensci.org/community/">Community</a></li>
                            <li><a href="https://ropensci.org/software-review/">Contribute software</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct">Code of conduct</a></li>
                            <li><a href="https://ropensci.org/events/">Events</a></li>
                            <li><a href="https://ropensci.org/commcalls/">Community calls</a></li>
                            <li><a href="https://ropensci.org/donate/">Donate</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" target="_blank">NumFOCUS</a></p>
                        <a href="http://numfocus.org" target="_blank"></a>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '799829e946e1f0f9cd5b5a782c6316b9',
    indexName: 'ropensci-infx',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
